---
import '@astrojs/starlight/style/markdown.css';
import Quiz from '../../../lib/components/Quiz.astro';

const { entry } = Astro.locals.starlightRoute || {};
const quiz = entry?.data?.quiz;
const pageId = entry?.id?.replace(/\.mdx?$/, '') || '';

// クイズデータを neuvecom-common 形式に変換
const quizQuestions = quiz?.map((q: { question: string; options: string[]; answer: number }) => ({
  question: q.question,
  options: q.options,
  correct: q.answer,
})) || [];
---

<div class="sl-markdown-content">
  <slot />
  {quizQuestions.length > 0 && (
    <div class="quiz-wrapper">
      <Quiz
        quizId={pageId}
        storageKeyPrefix="github-guide-quiz-"
        questions={quizQuestions}
        showAffiliate={true}
      />
    </div>
  )}
</div>

<style>
  .quiz-wrapper {
    margin-top: 3rem;
  }
</style>
